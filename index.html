<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–¢—Ä–µ–∫–µ—Ä –¥–æ–ª–≥–æ–≤</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background-color: #111827; color: #f9fafb; font-family: monospace; }
    input[type=number] { background: transparent; border: none; width: 100%; color: #f9fafb; text-align: center; }
    input[type=number]:focus { outline: none; background: #1f2937; }
    .badge { background-color: #10b981; color: black; font-weight: bold; padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; margin-right: 4px; }
  </style>
</head>
<body class="p-4">
  <div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold mb-2 text-center text-green-400">üíÄ –¢—Ä–µ–∫–µ—Ä –ü–æ–≥–∞—à–µ–Ω–∏—è –î–æ–ª–≥–æ–≤</h1>
    <p class="text-center mb-6 text-gray-300">–°–ª–µ–¥–∏ –∑–∞ –≤—ã–ø–ª–∞—Ç–∞–º–∏, —Ä–∞–¥—É–π—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å—É, –∫–∞–π—Ñ—É–π –æ—Ç –ø–æ—Ä—è–¥–∫–∞</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="bg-gray-900 p-4 rounded-xl shadow">
        <h2 class="text-xl font-semibold mb-2">üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <p>–û—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞: <span id="totalDebt" class="text-red-400">‚Äì</span></p>
        <p>–í—ã–ø–ª–∞—á–µ–Ω–æ: <span id="totalPaid" class="text-green-400">‚Äì</span></p>
        <p>–§–∏–Ω. –ø–æ–¥—É—à–∫–∞: <span id="totalReserve" class="text-blue-400">‚Äì</span></p>
        <p>–ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="totalProgress">‚Äì</span></p>
      </div>
      <div class="bg-gray-900 p-4 rounded-xl shadow">
        <canvas id="debtChart"></canvas>
      </div>
    </div>

    <div class="bg-gray-900 p-4 rounded-xl shadow mb-6 overflow-x-auto">
      <h2 class="text-xl font-semibold mb-2">üìÖ –í—ã–ø–ª–∞—Ç—ã –ø–æ –º–µ—Å—è—Ü–∞–º</h2>
      <table class="table-auto w-full text-xs text-center">
        <thead>
          <tr>
            <th>–ú–µ—Å—è—Ü</th><th>–ò–ø–æ—Ç–µ–∫–∞</th><th>–ê–≤—Ç–æ</th><th>–†–æ–¥–∏—Ç–µ–ª—è–º</th><th>–ú–∞–º–µ</th><th>–ö—Ä–µ–¥–∏—Ç</th><th>PS5</th><th>–†–µ–∑–µ—Ä–≤</th>
          </tr>
        </thead>
        <tbody id="paymentsBody" class="divide-y divide-gray-700"></tbody>
      </table>
    </div>

    <div class="bg-gray-900 p-4 rounded-xl shadow">
      <h2 class="text-xl font-semibold mb-2">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
      <div id="achievements" class="flex flex-wrap"></div>
    </div>
  </div>

<script>
let debtData = [
  {month: '–ò—é–ª—å', ps5: 0, credit: 0, auto: 0, mother: 0, parents: 0, mortgage: 0, reserve: 0},
  {month: '–ê–≤–≥—É—Å—Ç', ps5: 0, credit: 0, auto: 0, mother: 0, parents: 0, mortgage: 0, reserve: 0},
  {month: '–°–µ–Ω—Ç—è–±—Ä—å', ps5: 0, credit: 0, auto: 0, mother: 0, parents: 0, mortgage: 0, reserve: 0}
];

let initialBalances = {
  ps5: 28000,
  credit: 400000,
  auto: 1500000,
  mother: 400000,
  parents: 400000,
  mortgage: 2850508
};

function saveToStorage() {
  localStorage.setItem("debtData", JSON.stringify(debtData));
}

function loadFromStorage() {
  const saved = localStorage.getItem("debtData");
  if (saved) debtData = JSON.parse(saved);
}

function updateTable() {
  const tbody = document.getElementById('paymentsBody');
  tbody.innerHTML = '';
  debtData.forEach((row, i) => {
    tbody.innerHTML += `<tr>` +
      `<td>${row.month}</td>` +
      ['mortgage','auto','parents','mother','credit','ps5','reserve'].map(key =>
        `<td><input type="number" value="${row[key]}" onchange="editCell(${i}, '${key}', this.value)"></td>`
      ).join('') +
      `</tr>`;
  });
}

function editCell(i, key, val) {
  debtData[i][key] = +val;
  saveToStorage();
  updateStats();
  updateChart();
  updateAchievements();
}

function updateStats() {
  let paid = {ps5: 0, credit: 0, auto: 0, mother: 0, parents: 0, mortgage: 0, reserve: 0};
  debtData.forEach(r => {
    for (let k in paid) paid[k] += r[k];
  });
  const totalPaid = paid.ps5 + paid.credit + paid.auto + paid.mother + paid.parents + paid.mortgage;
  const totalDebt = Object.values(initialBalances).reduce((s,v)=>s+v,0) - totalPaid;
  const progress = Math.round((totalPaid / (totalPaid + totalDebt)) * 100);
  document.getElementById('totalDebt').innerText = totalDebt.toLocaleString() + ' ‚ÇΩ';
  document.getElementById('totalPaid').innerText = totalPaid.toLocaleString() + ' ‚ÇΩ';
  document.getElementById('totalReserve').innerText = paid.reserve.toLocaleString() + ' ‚ÇΩ';
  document.getElementById('totalProgress').innerText = progress + '%';
}

function updateAchievements() {
  const box = document.getElementById("achievements");
  box.innerHTML = "";
  const paid = debtData.reduce((a,r)=>({
    ps5: a.ps5 + r.ps5, credit: a.credit + r.credit, auto: a.auto + r.auto,
    mother: a.mother + r.mother, parents: a.parents + r.parents, mortgage: a.mortgage + r.mortgage,
    reserve: a.reserve + r.reserve
  }), {ps5:0, credit:0, auto:0, mother:0, parents:0, mortgage:0, reserve:0});
  if (paid.ps5 >= 28000) box.innerHTML += `<span class="badge">üéÆ PS5 –≤—ã–ø–ª–∞—á–µ–Ω</span>`;
  if (paid.credit >= 400000) box.innerHTML += `<span class="badge">üí≥ –ö—Ä–µ–¥–∏—Ç –ø–æ–≥–∞—à–µ–Ω</span>`;
  if (paid.reserve >= 500000) box.innerHTML += `<span class="badge">üíé –ü–æ–¥—É—à–∫–∞ 500K+</span>`;
  if (paid.auto >= 750000) box.innerHTML += `<span class="badge">üöó –ü–æ–ª–ø—É—Ç–∏ –ø–æ –∞–≤—Ç–æ</span>`;
}

let chart;
function updateChart() {
  const ctx = document.getElementById("debtChart").getContext("2d");
  const paid = debtData.reduce((a,r)=>({
    ps5: a.ps5 + r.ps5, credit: a.credit + r.credit, auto: a.auto + r.auto,
    mother: a.mother + r.mother, parents: a.parents + r.parents, mortgage: a.mortgage + r.mortgage,
    reserve: a.reserve + r.reserve
  }), {ps5:0, credit:0, auto:0, mother:0, parents:0, mortgage:0, reserve:0});
  const data = {
    labels: ['–ò–ø–æ—Ç–µ–∫–∞','–ê–≤—Ç–æ','–†–æ–¥–∏—Ç–µ–ª—è–º','–ú–∞–º–µ','–ö—Ä–µ–¥–∏—Ç','PS5'],
    datasets: [{
      data: [
        initialBalances.mortgage - paid.mortgage,
        initialBalances.auto - paid.auto,
        initialBalances.parents - paid.parents,
        initialBalances.mother - paid.mother,
        initialBalances.credit - paid.credit,
        initialBalances.ps5 - paid.ps5
      ],
      backgroundColor: ['#ef4444','#f97316','#facc15','#10b981','#3b82f6','#a855f7']
    }]
  };
  if (chart) chart.destroy();
  chart = new Chart(ctx, {type: 'doughnut', data});
}

document.addEventListener('DOMContentLoaded', () => {
  loadFromStorage();
  updateTable();
  updateStats();
  updateChart();
  updateAchievements();
});
</script>
</body>
</html>
